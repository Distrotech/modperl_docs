<html>
<head>
    <title>Log Handler Example</title> 
    <meta name="Description" content="Log Handler Example">
</head>
<body bgcolor="white">


<h1>Creating a PerlLogHandler</h1>

Every request phase can be controlled using mod_perl.  Here's an example
of a PerlLogHandler.  The PerlLogHandler is one of the last phases of the request
cycle.
</p>
<p>
This example sends mail when a request is made to the /private section of your
web space.  A more common use of a PerlLogHandler might be to track hits on a
specific set of URLs, or to write logging data to a relational database.
</p>

<pre>
    package My::Notify;
    use strict;
    use Apache::Constants(':common');

    use Mail::Send;

    sub handler {
        my $r = shift;

        my $email = $r-&gt;server-&gt;server_admin || return DECLINED;

        my $mail = Mail::Send->new(
            To      =&gt; $email,
            Subject =&gt; "mod_perl Notification",
        );
        my $file = $r->filename;
        my $fh = $mail-&gt;open;
        $fh-&gt;print("File '$file' was accessed");
        $fh-&gt;close;

        return DECLINED; # let apache write to the lot
    }
    1; # modules must return true
</pre>

<p>

The httpd.conf setup:


<pre>
    &lt;location /private&gt;
        SetHandler perl-script
        PerlLogHandler My::Notify
    &lt;/location&gt;
</pre>



<p>
<a class="more" href="../index.html#logging">&#171&nbsp;back</a>
</p>


</body>
</html>
