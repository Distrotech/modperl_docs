=head1 NAME

win32_compile - Apache mod_perl-1.xx installation instructions for Win32

=head1 DESCRIPTION

This document discusses how to build, test, configure and
install mod_perl under Win32.

=head1 PREREQUISITES

=over 3

patience - mod_perl is considered alpha under Win32.

MSVC++ 5.0+, Apache version 1.3-dev or higher and Perl 5.004_02 or higher.

As of version 1.24_01, mod_perl will build on Win32 ActivePerls
based on Perl-5.6.x (builds 6xx). For binary compatibility you 
should use the same compiler in building mod_perl that was used 
to compile your Perl binary; for ActivePerl, this means using VC++ 6.

=back

=head1 BUILDING

Obtain the mod_perl sources from CPAN:

  http://www.cpan.org/authors/id/D/DO/DOUGM/mod_perl-1.xx.tar.gz

When unpacked, using Winzip or similar tools, a subdirectory
F<mod_perl-1.xx> will be created.

There are two ways to build mod_perl - with MS Developer Studio,
and through command-line arguments to 'perl Makefile.PL'. In both
cases Apache should previously have been built and installed - if
you are using a binary build of Apache, make sure that you obtain
a binary build that includes the Apache libraries and header files.

=head2 Building with MS Developer Studio

=over 3

=item Setup the Perl side

Run, from a DOS window in the top-level directory of the 
mod_perl sources,

  perl Makefile.PL
  nmake

This will set up the Perl side of mod_perl for the library build.

=item Build mod_perl.so

Using MS developer studio, 

 select "File -> Open Workspace ...", 
 select "Files of type [Projects (*.dsp)]"
 open mod_perl-x.xx/src/modules/win32/mod_perl.dsp

=item Settings

 select "Tools -> Options -> [Directories]"
 
 select "Show directories for: [Include files]", and add
 
   C:\Apache\include
   .  (should expand to C:\...\mod_perl-x.xx\src\modules\perl)
   C:\Perl\lib\Core

 select "Project -> Add to Project -> Files", adding:
 
   perl.lib (or perl56.lib)   (e.g. C:\perl\lib\Core\perl.lib)
   ApacheCore.lib (e.g. C:\Apache\ApacheCore.lib)

 select "Build -> Set Active Configuration -> [mod_perl - Win32 Release]"

 select "Build -> Build mod_perl.so"

You may see some harmless warnings, which can be reduced (along with
the size of the DLL), by setting:

 "Project -> Settings -> [C/C++] -> Category: [Code Generation] -> 
  Use runtime library: [Multithreaded DLL]

=item Testing

Once mod_perl.so is built you may test mod_perl with:

   nmake test

after which, assuming the tests are OK,

   nmake install

will install the Perl side of mod_perl. The mod_perl.so file
built under F<mod_perl-1.xx/src/modules/win32/Release> should
be copied to your Apache modules directory (eg, F<C:\Apache\modules>).

=back

=head2 Building with arguments to C<perl Makefile.PL>

Generating the Makefile as, for example,

 perl Makefile.PL APACHE_SRC=\Apache INSTALL_DLL=\Apache\modules

will build mod_perl (including mod_perl.so) entirely from 
the command line. The arguments accepted include

=over 3

=item APACHE_SRC

This can be one of two values: either the path to the Apache build
directory (eg, F<..\apache_1.3.xx>), or to the installed Apache location
(eg, F<\Apache>). This is used to set the locations of ApacheCore.lib
and the Apache header files.

=item INSTALL_DLL

This gives the location of where to install mod_perl.so
(eg, F<\Apache\modules>). No default is assumed - if this argument
is not given, mod_perl.so must be copied manually.

=item DEBUG

If true (DEBUG=1), a Debug version will be built (this assumes
that a Debug Apache has been built). If false, or not given, 
a Release version will be built.

=item EAPI

If true (EAPI=1), EAPI (Extended API) will be defined when
compiling. This is useful when building mod_perl against mod_ssl 
patched Apache sources. If false, or not given, EAPI will
not be defined.

=back

After this, running

   nmake
   nmake test
   nmake install

will complete the installation.

This latter method of building mod_perl will also install the
Apache and mod_perl header files, which can then be accessed
through the Apache::src module.

=head1 CONFIGURATION

Add this line to F<C:\Apache\conf\httpd.conf>:

 LoadModule perl_module modules/mod_perl.so

Be sure that the path to your Perl binary (eg, F<C:\Perl\bin>)
is in your C<PATH> environment variable. If you have a C<ClearModuleList> 
directive enabled in F<httpd.conf>, you may also need to add

 AddModule mod_perl.c

See the descriptions of the C<ClearModuleList> and C<AddModule>
directives in the Apache documents for more details, especially
concerning the relative order of these and the C<LoadModule> directive.

=head1 SEE ALSO

The I<mod_perl> manpage, the L<Apache> manpage,
http://perl.apache.org/, especially the guide, and http://take23.org/.

=head1 Maintainers

Maintainer is the person(s) you should contact with updates,
corrections and patches.

=over

=item * 

Randy Kobes E<lt>randy@theoryx5.uwinnipeg.caE<gt>

=back


=head1 Authors

=over

=item *

Randy Kobes E<lt>randy@theoryx5.uwinnipeg.caE<gt>

=back

Only the major authors are listed above. For contributors see the
Changes file.


=cut
